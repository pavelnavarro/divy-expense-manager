{% extends "layout.html" %}
{% block title %}Register â€“ Divy{% endblock %}
{% block content %}
  <h2>Register</h2>
  <form id="register-form">
    <label>Username <input name="username" /></label><br>
    <label>Email <input name="email" type="email" /></label><br>
    <label>Password <input name="password" type="password" /></label><br>
    <button type="submit">Register</button>
  </form>
  <script>
    document.getElementById('register-form').onsubmit = async e => {
      e.preventDefault();
      const data = {
        username: e.target.username.value,
        email:    e.target.email.value,
        password: e.target.password.value
      };
      const resp = await fetch('/api/auth/register', {
        method:'POST', headers:{'Content-Type':'application/json'},
        body: JSON.stringify(data)
      });
      if (resp.ok) {
        alert('Registered! Please log in.');
        location.href = '/login';
      } else {
        alert('Registration failed');
      }
    };
  </script>
{% endblock %}
