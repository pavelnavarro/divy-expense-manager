{% extends "layout.html" %}
{% block title %}Add Expense | Divy{% endblock %}

{% block content %}
<h2>Add Expense</h2>
<form id="expenseForm" enctype="multipart/form-data">
  <!-- Type selector -->
  <div class="form-group">
    <label for="type">Type</label>
    <select id="type" name="type" class="form-control" required>
      <option value="personal">Personal</option>
      <option value="shared">Shared</option>
    </select>
  </div>

  <!-- Amount or Receipt (shared) -->
  <div class="form-group" id="amountGroup">
    <label for="amount">Amount $USD</label>
    <input type="number" id="amount" name="amount" step="0.01" class="form-control" placeholder="0.00">
  </div>
  <div class="form-group" id="receiptGroup" style="display:none;">
    <label for="receipt">Or upload receipt image</label>
    <input type="file" id="receipt" name="receipt" accept="image/*" class="form-control-file">
  </div>

  <!-- Description -->
  <div class="form-group">
    <label for="description">Description</label>
    <input type="text" id="description" name="description" class="form-control" placeholder="What was this for?" required>
  </div>

  <!-- Transaction Date -->
  <div class="form-group">
    <label for="date">Transaction Date</label>
    <input type="date" id="date" name="date" class="form-control" required>
  </div>

  <!-- Shared-only fields -->
  <div id="sharedSection" style="display:none;">
    <!-- No groups message -->
    <div id="noGroups" class="alert alert-warning" style="display:none;">
      You are not in any groups. Cannot add a shared expense.
    </div>

    <!-- Group dropdown -->
    <div id="groupSection" class="form-group" style="display:none;">
      <label for="group">Group</label>
      <select id="group" name="group_id" class="form-control"></select>
    </div>

    <!-- Who paid -->
    <div class="form-group">
      <label for="paidBy">Who paid?</label>
      <select id="paidBy" name="paid_by" class="form-control" required></select>
    </div>

    <!-- Context / Notes -->
    <div class="form-group">
      <label for="notes">Context / Notes (optional)</label>
      <textarea id="notes" name="context" class="form-control" placeholder="Extra details for AI (optional)"></textarea>
    </div>
  </div>

  <button type="submit" class="btn btn-primary">Submit</button>
</form>

<!-- Result message -->
<div id="resultMessage" class="mt-3"></div>

{% block scripts %}
<script src="{{ url_for('static', filename='js/expense.js') }}"></script>
{% endblock %}
{% endblock %}
