{% extends "layout.html" %}
{% block title %}Add Expense | Divy{% endblock %}

{% block content %}
<h2 class="page-title">Add Expense</h2>

<form id="expenseForm" enctype="multipart/form-data" class="form-styled">
  <!-- Type selector -->
  <div class="form-group">
    <label for="type" class="form-label">Type</label>
    <select id="type" name="type" class="form-control form-input" required>
      <option value="personal">Personal</option>
      <option value="shared">Shared</option>
    </select>
  </div>

  <!-- Amount or Receipt (shared) -->
  <div class="form-group" id="amountGroup">
    <label for="amount" class="form-label">Amount $USD</label>
    <input type="number" id="amount" name="amount" step="0.01" class="form-control form-input" placeholder="0.00">
  </div>

  <div class="form-group" id="receiptGroup" style="display:none;">
    <label for="receipt" class="form-label">Coming soon...</label>
    <input type="file" id="receipt" name="receipt" accept="image/*" class="form-control-file">
  </div>

  <!-- Description -->
  <div class="form-group">
    <label for="description" class="form-label">Description</label>
    <input type="text" id="description" name="description" class="form-control form-input" placeholder="What was this for?" required>
  </div>

  <!-- Transaction Date -->
  <div class="form-group">
    <label for="date" class="form-label">Transaction Date</label>
    <input type="date" id="date" name="date" class="form-control form-input" required>
  </div>

  <!-- Shared-only fields -->
  <div id="sharedSection" style="display:none;">
    <div id="noGroups" class="alert alert-warning" style="display:none;">
      You are not in any groups. Cannot add a shared expense.
    </div>

    <div id="groupSection" class="form-group" style="display:none;">
      <label for="group" class="form-label">Group</label>
      <select id="group" name="group_id" class="form-control form-input"></select>
    </div>

    <div class="form-group">
      <label for="paidBy" class="form-label">Who paid?</label>
      <select id="paidBy" name="paid_by" class="form-control form-input" required></select>
    </div>

    <div class="form-group">
      <label for="notes" class="form-label">Notes</label>
      <textarea id="notes" name="context" class="form-control form-input" placeholder="Extra details for AI (optional)"></textarea>
    </div>
  </div>

  <button type="submit" class="btn btn-dark mt-3">Submit</button>
</form>

<div id="resultMessage" class="mt-3 result-message"></div>

{% block scripts %}
<script src="{{ url_for('static', filename='js/expense.js') }}"></script>
{% endblock %}
{% endblock %}
